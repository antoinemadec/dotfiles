#!/bin/bash

set -e

cmd="$1"
[ "$cmd" = "" ] && cmd="vim"

rm -rf ${cmd}_profile
mkdir -p ${cmd}_profile
cd ${cmd}_profile

$cmd ~/.vimrc --startuptime profile.txt
grep sourcing profile.txt | grep -v "/$cmd/" | sed 's/^\S* *//' | sort -nr > sourcing.txt

$cmd profile.txt sourcing.txt -o
