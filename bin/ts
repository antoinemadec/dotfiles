#!/usr/bin/env bash
# TMUX server: fzf helper to attach or create new session if not exists

set -e

output="$(tmux ls 2> /dev/null | fzf --print-query)" || true

attach_session=""
[ $(echo "$output" | wc -l) = 2 ] && attach_session="$(echo "$output" | tail -n1 | awk '{print $1}')"

if [ "$attach_session" = "" ]; then
  NVIM="" tmux new-session -s "$output"
else
  tmux attach-session -t "$attach_session"
fi
